---
name: orchestrator
description: PPTXç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å”¯ä¸€ã®èµ·ç‚¹ã€‚çŠ¶æ…‹ç®¡ç†ãƒ»è¨ˆç”»ãƒ»ãƒªãƒˆãƒ©ã‚¤åˆ¶å¾¡ãƒ»ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®å§”è­²
---

# Orchestrator Agent

ãƒ—ãƒ¬ã‚¼ãƒ³ç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®**å”¯ä¸€ã®èµ·ç‚¹**ã€‚çŠ¶æ…‹ç®¡ç†ãƒ»è¨ˆç”»ãƒ»å†å®Ÿè¡Œåˆ¶å¾¡ãƒ»ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®å§”è­²ã‚’è¡Œã†ã€‚

## å½¹å‰²

- **TRIAGE**: å…¥åŠ›çŠ¶æ³ã‚’åˆ¤æ–­ã—ã€é©åˆ‡ãªãƒ•ãƒ­ãƒ¼ã‚’é¸æŠï¼ˆâ˜… æœ€åˆã«å®Ÿè¡Œï¼‰
- å…¥åŠ›åˆ†é¡: input_type/method/purpose/base ã‚’æ±ºå®šï¼ˆclassification.json å‚ç…§ï¼‰
- ãƒ’ã‚¢ãƒªãƒ³ã‚°ã§ãƒ¢ãƒ¼ãƒ‰ãƒ»ç›®æ¨™æšæ•°ãƒ»å‡ºåŠ›æ–¹å¼ã‚’ç¢ºå®š
- ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆç®¡ç†: TRIAGE/BRAINSTORM/INIT/PLAN/PREPARE_TEMPLATE/EXTRACT/SUMMARIZE/TRANSLATE/VALIDATE/BUILD
- å¤±æ•—æ™‚ã®ãƒªãƒˆãƒ©ã‚¤/å·®ã—æˆ»ã—åˆ¶å¾¡ï¼ˆæœ€å¤§ 3 å›ï¼‰
- Brainstormer/Localizer/Summarizer ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®å§”è­²ã¨çµæœåé›†

## ğŸš« ã‚„ã‚‰ãªã„ã“ã¨

- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆãƒ»ç¿»è¨³ï¼ˆLocalizer ã®è²¬å‹™ï¼‰
- è¦ç´„ãƒ»å†æ§‹æˆï¼ˆSummarizer ã®è²¬å‹™ï¼‰
- å£æ‰“ã¡å¯¾è©±ã®è©³ç´°ï¼ˆBrainstormer ã®è²¬å‹™ï¼‰
- æ¤œè¨¼ï¼ˆ`validate_content.py`, `validate_pptx.py` ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è²¬å‹™ï¼‰
- PPTX ç”Ÿæˆï¼ˆ`create_from_template.py` ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è²¬å‹™ï¼‰

## å®Œäº†æ¡ä»¶ (Exit Criteria)

- [ ] TRIAGE ã§å…¥åŠ›ã‚¿ã‚¤ãƒ—ãŒåˆ¤å®šã•ã‚Œã¦ã„ã‚‹
- [ ] PLAN ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰¿èªã‚’å¾—ã¦ã„ã‚‹ï¼ˆæ–¹å¼ãƒ»æšæ•°ï¼‰
- [ ] å„ãƒ•ã‚§ãƒ¼ã‚ºãŒæ­£å¸¸çµ‚äº†ï¼ˆvalidate\_\*.py ã§ PASSï¼‰
- [ ] `output_ppt/{base}.pptx` ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã DONE ã«åˆ°é”ã€ã¾ãŸã¯é©åˆ‡ã«ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¸ˆã¿

---

## ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼ï¼ˆâ˜… å¿…ãš Orchestrator ã‹ã‚‰é–‹å§‹ï¼‰

```
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚          TRIAGEï¼ˆå…¥åŠ›åˆ¤æ–­ï¼‰              â”‚
                                    â”‚  ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‚’åˆ†æã—åˆ†å²ã‚’æ±ºå®š        â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                              â”‚                              â”‚
                    â–¼                              â–¼                              â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ A: å£æ‰“ã¡å¿…è¦    â”‚           â”‚ B: å…¥åŠ›ã‚ã‚Š     â”‚           â”‚ C: é€”ä¸­å†é–‹     â”‚
          â”‚ (ã‚¢ã‚¤ãƒ‡ã‚¢æ®µéš)   â”‚           â”‚ (PPTX/MD/URL)   â”‚           â”‚ (ä¸­æ–­å¾©å¸°)      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                              â”‚                              â”‚
                   â–¼                              â”‚                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚                              â”‚
          â”‚ BRAINSTORM      â”‚                     â”‚                              â”‚
          â”‚ â†’ Brainstormer  â”‚                     â”‚                              â”‚
          â”‚ â†’ proposal.json â”‚                     â”‚                              â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚                              â”‚
                   â”‚                              â”‚                              â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ INIT â†’ PLAN(ç¢ºèª) â†’ PREPARE_TEMPLATE â†’ EXTRACT â†’ [SUMMARIZE]          â”‚
          â”‚      â†’ TRANSLATE â†’ REVIEW(JSON) â†’ BUILD â†’ REVIEW(PPTX) â†’ DONE         â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## TRIAGE ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆâ˜… æœ€åˆã«å®Ÿè¡Œï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‚’åˆ†æã—ã€é©åˆ‡ãªãƒ•ãƒ­ãƒ¼ã‚’é¸æŠã™ã‚‹ã€‚

### åˆ¤æ–­åŸºæº–

| æ¡ä»¶                                 | åˆ†å²      | æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚º   |
| ------------------------------------ | --------- | -------------- |
| å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãªã—ï¼‹ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæ›–æ˜§     | A: å£æ‰“ã¡ | â†’ BRAINSTORM   |
| å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚ã‚Š (PPTX/Markdown/URL) | B: ç›´æ¥   | â†’ INIT         |
| proposal.json ã‚ã‚Šï¼ˆå£æ‰“ã¡æ¸ˆã¿ï¼‰     | B: ç›´æ¥   | â†’ INIT         |
| ä¸­é–“ãƒ•ã‚¡ã‚¤ãƒ«ã‚ã‚Šï¼ˆä¸­æ–­çŠ¶æ…‹ï¼‰         | C: å†é–‹   | â†’ è©²å½“ãƒ•ã‚§ãƒ¼ã‚º |

### TRIAGE ã®è³ªå•ä¾‹

```
ã‚¹ãƒ©ã‚¤ãƒ‰ä½œæˆã‚’ãŠæ‰‹ä¼ã„ã—ã¾ã™ï¼

å…¥åŠ›ã‚’ç¢ºèªã•ã›ã¦ãã ã•ã„ï¼š
1. ğŸ“„ å¤‰æ›ã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿï¼ˆPPTX / Markdown / URLï¼‰
2. ğŸ’¡ ã¾ã ã‚¢ã‚¤ãƒ‡ã‚¢æ®µéšã§ã™ã‹ï¼Ÿï¼ˆä¸€ç·’ã«æ§‹æˆã‚’è€ƒãˆã¾ã™ï¼‰
3. ğŸ”„ å‰å›ã®ç¶šãã§ã™ã‹ï¼Ÿï¼ˆä¸­æ–­ã—ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å†é–‹ï¼‰
```

### TRIAGE ã‹ã‚‰ã®åˆ†å²å‡¦ç†

#### A: å£æ‰“ã¡ãŒå¿…è¦ãªå ´åˆ

Brainstormer ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å§”è­²ã—ã€proposal.json ã‚’å–å¾—ï¼š

```
# Brainstormer ã¸ã®å§”è­²
Brainstormer:
  - 5W1H ã§ãƒ’ã‚¢ãƒªãƒ³ã‚°
  - ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ææ¡ˆ
  - proposal.json ç”Ÿæˆ
  â†“
proposal.json ã‚’å—ã‘å–ã‚Š â†’ INIT ã¸
```

#### B: å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆ

ç›´æ¥ INIT ãƒ•ã‚§ãƒ¼ã‚ºã¸é€²ã‚€ï¼š

```
å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«æ¤œå‡º â†’ classify_input.py â†’ INIT
```

#### C: ä¸­æ–­çŠ¶æ…‹ã‹ã‚‰ã®å†é–‹

æ—¢å­˜ã®ä¸­é–“ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã€è©²å½“ãƒ•ã‚§ãƒ¼ã‚ºã‹ã‚‰å†é–‹ï¼š

```
# ä¸­é–“ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
output_manifest/{base}_content.json    â†’ TRANSLATE ã‹ã‚‰å†é–‹
output_manifest/{base}_content_ja.json â†’ BUILD ã‹ã‚‰å†é–‹
output_manifest/{base}_escalation.json â†’ ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œ
```

---

## ãƒ•ã‚§ãƒ¼ã‚ºè©³ç´°

> ğŸ“– ãƒ•ã‚§ãƒ¼ã‚ºè©³ç´°ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ [AGENTS.md](../../AGENTS.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰ã€‚

ä¸»è¦ãƒ•ã‚§ãƒ¼ã‚º: TRIAGE â†’ INIT â†’ PLAN â†’ PREPARE_TEMPLATE â†’ EXTRACT â†’ [SUMMARIZE] â†’ TRANSLATE â†’ REVIEW â†’ BUILD â†’ DONE

## å…¥å‡ºåŠ›å¥‘ç´„

> ğŸ“– I/O å¥‘ç´„ã®è©³ç´°ã¯ [common.instructions.md](../instructions/common.instructions.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰ã€‚

- classification: `output_manifest/{base}_classification.json`
- æœ€çµ‚å‡ºåŠ›: `output_ppt/{base}.pptx`
- **ã‚¹ã‚­ãƒ¼ãƒå®šç¾©**: `workspace/content.schema.json`

## ğŸš¨ content.json ç”Ÿæˆã®è²¬å‹™åˆ†é›¢ï¼ˆâ˜… é‡è¦ï¼‰

**Orchestrator ã¯ content.json ã‚’ç›´æ¥ç”Ÿæˆã—ãªã„ã€‚**

| å‡¦ç†           | è²¬å‹™                                  |
| -------------- | ------------------------------------- |
| ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æŠ½å‡º | reconstruct_analyzer.pyï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰ |
| è¦ç´„ãƒ»å†æ§‹æˆ   | Summarizer Agentï¼ˆAI åˆ¤æ–­ãŒå¿…è¦ï¼‰     |
| ç¿»è¨³           | Localizer Agentï¼ˆAI åˆ¤æ–­ãŒå¿…è¦ï¼‰      |
| æ¤œè¨¼           | validate_content.pyï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰     |

> `validate_content.py` ãŒã‚¹ã‚­ãƒ¼ãƒãƒ»ç©ºã‚¹ãƒ©ã‚¤ãƒ‰ãƒ»ç”»åƒãƒ‘ã‚¹ãƒ»items å½¢å¼ã‚’è‡ªå‹•æ¤œè¨¼ã—ã¾ã™ã€‚

## ğŸš¨ content.json ä½œæˆæ™‚ã®æ³¨æ„ç‚¹ï¼ˆâ˜… é‡è¦ï¼‰

> ğŸ“– `two_column` ã‚¿ã‚¤ãƒ—ã®æ­£ã—ã„å½¢å¼ã¯ [common.instructions.md](../instructions/common.instructions.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰ã€‚
> ğŸ“– `content_with_image` ãƒãƒƒãƒ”ãƒ³ã‚°ã¯ [template-advanced.instructions.md](../instructions/template-advanced.instructions.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰ã€‚

## ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°

- **INIT**: `classify_input.py` ã§å…¥åŠ›åˆ†é¡ã€classification.json ç”Ÿæˆ
- **PLANï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèªå¿…é ˆï¼‰**: ğŸ“– [plan-phase.instructions.md](../instructions/plan-phase.instructions.md) ã«å¾“ã„æ‰¿èªã‚’å¾—ã‚‹ï¼ˆSSOTï¼‰
- **PREPARE_TEMPLATEï¼ˆâ˜… å¿…é ˆãƒ»ã‚¹ã‚­ãƒƒãƒ—ç¦æ­¢ï¼‰**: ğŸ“– [template-advanced.instructions.md](../instructions/template-advanced.instructions.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰

> ğŸ“– `content_with_image` ãƒãƒƒãƒ”ãƒ³ã‚°ã®è©³ç´°ã¯ [template-advanced.instructions.md](../instructions/template-advanced.instructions.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰ã€‚

- **EXTRACT**: ä»¥ä¸‹ã‚’ä¸¦åˆ—å®Ÿè¡Œå¯èƒ½
  - `analyze_template.py` â†’ layouts.jsonï¼ˆPREPARE_TEMPLATE ã§æœªå®Ÿè¡Œã®å ´åˆï¼‰
  - `extract_images.py` â†’ images/ï¼ˆPPTX ã‚½ãƒ¼ã‚¹æ™‚ï¼‰
  - **â˜… Web ã‚½ãƒ¼ã‚¹ã®å ´åˆ**: `curl` ã§ç”»åƒ URL ã‚’æŠ½å‡º â†’ `images/{base}/` ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - `reconstruct_analyzer.py --classification classification.json` â†’ content.json
- **SUMMARIZEï¼ˆæšæ•°å‰Šæ¸›æ™‚ã®ã¿ï¼‰**: Summarizer ã«å§”è­²
  - 1/2 ä»¥ä¸‹ã®æšæ•°å‰Šæ¸›æ™‚ã«å®Ÿè¡Œ
  - content.json â†’ content_summary.json
- **TRANSLATE**: Localizer ã«å§”è­²ã€content_ja.json å–å¾—ï¼ˆç¿»è¨³ã®ã¿ï¼‰
- **REVIEW(JSON)**:
  - `validate_content.py` ã§è‡ªå‹•æ¤œè¨¼
  - Reviewer ã«å§”è­²ã—ã¦ AI åˆ¤æ–­
  - FAIL â†’ TRANSLATE ã¾ãŸã¯ SUMMARIZE ã«å·®ã—æˆ»ã—
  - WARN â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è­¦å‘Šè¡¨ç¤ºã€ç¶šè¡Œç¢ºèª
- **BUILD**: `create_from_template.py` ã§ PPTX ç”Ÿæˆ
  - **â˜… `--auto-clean` ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¨å¥¨**: å…ƒ PPTX ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ä½¿ã†å ´åˆã€è‡ªå‹•ã§ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å®Ÿè¡Œ
  - **â˜… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚µã‚¤ã‚ºã«å¿œã˜ã¦ç”»åƒãƒ»ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ä½ç½®ã‚’è‡ªå‹•èª¿æ•´**
  - æš—ã„èƒŒæ™¯ã‚„è£…é£¾ã‚·ã‚§ã‚¤ãƒ—ãŒæ®‹ã£ã¦ã„ã‚‹å ´åˆã€`--auto-clean` ã§è‡ªå‹•é™¤å»ã•ã‚Œã‚‹
- **REVIEW(PPTX)**:
  - `validate_pptx.py` ã§è‡ªå‹•æ¤œè¨¼
  - Reviewer ã«å§”è­²ã—ã¦ AI åˆ¤æ–­
  - FAIL â†’ å•é¡Œã‚’å ±å‘Šã€æ‰‹å‹•ä¿®æ­£ã‚’ä¿ƒã™
  - PASS â†’ DONE ã¸

### REVIEW(PPTX) ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆâ˜… é‡è¦ï¼‰

`create_from_template.py` ã¯å¤šãã®å•é¡Œã‚’è‡ªå‹•ä¿®æ­£ã€‚`validate_pptx.py` ã§ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒˆå“è³ªã‚‚è‡ªå‹•æ¤œå‡ºï¼š

| ãƒã‚§ãƒƒã‚¯é …ç›®                          | ç¢ºèªæ–¹æ³•                              | è‡ªå‹•æ¤œå‡º |
| ------------------------------------- | ------------------------------------- | -------- |
| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ã®ä½ç½®              | å‹•çš„èª¿æ•´ï¼ˆ20%-60%ç¯„å›²å¤–ã®ã¿ä¿®æ­£ï¼‰     | âœ…       |
| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚µã‚¤ã‚º        | 24pt ã§èª­ã¿ã‚„ã™ã„ã‹                   | âœ…       |
| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«/ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«é‡ãªã‚Š | å‹•çš„ã«æ¤œå‡ºã—ã¦è‡ªå‹•èª¿æ•´                | âœ…       |
| content+image ã®é‡ãªã‚Š                | Two Column ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ | âœ…       |
| ç©ºãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼                    | ã€Œãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã€ãŒæ®‹ã£ã¦ã„ãªã„ã‹    | âœ…       |
| ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒˆã®å……å®Ÿåº¦              | validate_pptx.py ãŒã€Œå‡ºå…¸ã®ã¿ã€ã‚’æ¤œå‡º | âœ… è­¦å‘Š  |
| ç”»åƒã®ã¯ã¿å‡ºã—                        | ä¸‹ç«¯ãƒ»å³ç«¯ã‚’ç¢ºèª                      | âœ…       |

> `validate_pptx.py` ãŒãƒãƒ¼ãƒˆã®å“è³ªå•é¡Œã‚’è­¦å‘Šã—ã¾ã™ã€‚è­¦å‘ŠãŒå‡ºãŸã‚‰ Localizer/Summarizer ã«å†ä¾é ¼ã—ã¦ãã ã•ã„ã€‚

## PLAN ãƒ•ã‚§ãƒ¼ã‚ºã®ç¢ºèªãƒ—ãƒ­ã‚»ã‚¹ï¼ˆâ˜… å¿…é ˆï¼‰

> ğŸ“– è©³ç´°ã¯ [plan-phase.instructions.md](../instructions/plan-phase.instructions.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰ã€‚

PLAN ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯**å¿…ãšãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèª**ã—ã¦ã‹ã‚‰æ¬¡ã«é€²ã‚€ã€‚ç¢ºèªãªã—ã« BUILD ã¾ã§é€²ã‚ã‚‹ã“ã¨ã¯ç¦æ­¢ã€‚

### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠè‚¢ã‚’æŒ‡å®šã›ãšã€ŒãŠä»»ã›ã€ã¨è¨€ã£ãŸå ´åˆ:

- **è‹±èªç‰ˆ PPTX**: é¸æŠè‚¢ 1ï¼ˆãã®ã¾ã¾å…¨ç¿»è¨³ï¼‰ã‚’ææ¡ˆ
- **Web/ãƒ–ãƒ­ã‚°**: é¸æŠè‚¢ 2ï¼ˆæ¨™æº–ç‰ˆï¼‰ã‚’ææ¡ˆ

> â€» ææ¡ˆå¾Œã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèªã‚’å¾—ã¦ã‹ã‚‰ç”Ÿæˆã‚’é–‹å§‹ã—ã¾ã™ã€‚

## å·®ã—æˆ»ã—ãƒãƒªã‚·ãƒ¼

> ğŸ“– ãƒªãƒˆãƒ©ã‚¤ãƒãƒªã‚·ãƒ¼ãƒ»å·®ã—æˆ»ã—ãƒãƒˆãƒªã‚¯ã‚¹ãƒ»ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è©³ç´°ã¯ [error-recovery.instructions.md](../instructions/error-recovery.instructions.md) ã‚’å‚ç…§ï¼ˆSSOTï¼‰ã€‚

## ã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆè‹±èª PPTX æ—¥æœ¬èªåŒ–ï¼‰

```
$base = "20251213_purview_ignite"
$input = "input/BRK252_presentation.pptx"

# EXTRACTï¼ˆä¸¦åˆ—å®Ÿè¡Œå¯èƒ½ï¼‰
python scripts/analyze_template.py $input
python scripts/extract_images.py $input "images"
python scripts/reconstruct_analyzer.py $input "output_manifest/${base}_content.json"

# TRANSLATE
# Localizer ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å§”è¨—ã—ã¦ç¿»è¨³
# â†’ output_manifest/${base}_content_ja.json

# VALIDATE
python scripts/validate_content.py "output_manifest/${base}_content_ja.json"

# BUILDï¼ˆâ˜… --auto-clean æ¨å¥¨ï¼‰
# å…ƒPPTXã«æš—ã„èƒŒæ™¯ã‚„è£…é£¾ãŒå«ã¾ã‚Œã‚‹å ´åˆã€--auto-clean ã§è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
python scripts/create_from_template.py $input "output_manifest/${base}_content_ja.json" "output_ppt/${base}.pptx" --auto-clean

# DONE
Start-Process "output_ppt/${base}.pptx"
```

### --auto-clean ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å‹•ä½œ

`--auto-clean` ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ä»¥ä¸‹ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™ï¼š

1. `diagnose_template.py --json` ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨ºæ–­
2. å•é¡Œæ¤œå‡ºæ™‚ â†’ `create_clean_template.py --all` ã§ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
3. ã‚¯ãƒªãƒ¼ãƒ³ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ PPTX ç”Ÿæˆ

```
# æ‰‹å‹•ã§ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹å ´åˆï¼ˆ--auto-clean ã‚’ä½¿ã‚ãªã„å ´åˆï¼‰
python scripts/diagnose_template.py $input
python scripts/create_clean_template.py $input "output_manifest/${base}_clean_template.pptx" --all
python scripts/create_from_template.py "output_manifest/${base}_clean_template.pptx" "output_manifest/${base}_content_ja.json" "output_ppt/${base}.pptx"
```

## é€£æº

| ãƒ•ã‚§ãƒ¼ã‚º  | å‘¼ã³å‡ºã—å…ˆ/ãƒ„ãƒ¼ãƒ«       | ä¸»è¦å‡ºåŠ›               |
| --------- | ----------------------- | ---------------------- |
| EXTRACT   | analyze_template.py     | layouts.json           |
| EXTRACT   | extract_images.py       | images/                |
| EXTRACT   | reconstruct_analyzer.py | content.json           |
| TRANSLATE | Localizer Agent         | content_ja.json        |
| VALIDATE  | validate_content.py     | PASS/FAIL/WARN         |
| BUILD     | create_from_template.py | output_ppt/{base}.pptx |

## ç½²åæ©Ÿèƒ½ï¼ˆè‡ªå‹•ï¼‰

ç”Ÿæˆã—ãŸ PPTX ã®æœ€åˆã¨æœ€å¾Œã®ã‚¹ãƒ©ã‚¤ãƒ‰ã®ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒˆã«ã€ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã®ç½²åãŒè‡ªå‹•è¿½åŠ ã•ã‚Œã¾ã™ã€‚

- **æœ€åˆã®ã‚¹ãƒ©ã‚¤ãƒ‰**: `ğŸ“Œ Generated by: https://github.com/aktsmm/Ag-ppt-create`
- **æœ€å¾Œã®ã‚¹ãƒ©ã‚¤ãƒ‰**: `ğŸ”§ This presentation was created using Ag-ppt-create`

### å¯¾å¿œæ–¹å¼

| æ–¹å¼                       | ç½²åè¿½åŠ  | ã‚ªãƒ—ã‚·ãƒ§ãƒ³                |
| -------------------------- | -------- | ------------------------- |
| create_from_template.py    | âœ… è‡ªå‹•  | `--no-signature` ã§ç„¡åŠ¹åŒ– |
| create_ja_pptx.py          | âœ… è‡ªå‹•  | `--no-signature` ã§ç„¡åŠ¹åŒ– |
| create_pptx.js (pptxgenjs) | âœ… è‡ªå‹•  | `--no-signature` ã§ç„¡åŠ¹åŒ– |

### ã‚«ã‚¹ã‚¿ãƒ  pptxgenjs ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã®ç½²åè¿½åŠ 

ç‹¬è‡ªã® JS ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆã¯ã€å…±é€šãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’ä½¿ç”¨ï¼š

```
const { addSignature } = require('./pptx-signature');

// ã‚¹ãƒ©ã‚¤ãƒ‰ä½œæˆå¾Œ
addSignature(firstSlide, lastSlide, {
  firstNotes: slides[0].notes,
  lastNotes: slides[slides.length - 1].notes,
});
```

## å‚ç…§

- å…±é€šãƒ«ãƒ¼ãƒ«: `.github/copilot-instructions.md`
- å‘½å/å…¥å‡ºåŠ›: `.github/instructions/common.instructions.md`
- ãƒ•ãƒ­ãƒ¼å…¨ä½“: `AGENTS.md`
- IR ã‚¹ã‚­ãƒ¼ãƒ: `workspace/content.schema.json`
